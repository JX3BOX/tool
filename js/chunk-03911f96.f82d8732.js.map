{"version":3,"sources":["webpack:///./src/components/design/map.vue?2ab0","webpack:///./src/components/design/map.vue","webpack:///./src/service/maps.js","webpack:///src/components/design/map.vue","webpack:///./src/components/design/map.vue?78e7","webpack:///./src/components/design/map.vue?f85f"],"names":["render","_vm","this","_c","_self","staticClass","ref","mapId","attrs","currentMap","on","handleMouseDown","handleMouseMove","handleMouseUp","handleWheel","style","concat","scale","elWidth","elHeight","zoomOriginX","zoomOriginY","meter_zoom","isDragging","_l","mapData","item","id","key","x","y","$event","changeMap","mapid","_v","_s","comment","map","traffic","title","model","value","search","callback","$$v","expression","slot","changePage","class","maps","ID","active","MapName","Name","staticRenderFns","$","$node","getMaps","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","wrap","_context","prev","next","abrupt","get","stop","_x","apply","arguments","getMapsPoint","_ref2","_callee2","_context2","_x2","name","data","loading","page","per","count","initWidth","initHeight","dragStartX","dragStartY","click","computed","__imgPath","client","$store","state","_params","watch","deep","handler","load","val","undefined","map_1","filter","map_2","mounted","loadOther","initBodySize","methods","$options","_this","then","res","list","finally","_this2","city","obj","_obj$comment","includes","event","_this$scale","delta","deltaY","deltaX","scaleNum","boundingRect","$refs","getBoundingClientRect","mouseX","Math","floor","clientX","right","mouseY","clientY","bottom","transformOrigin","transform","preventDefault","imageWidth","imageHeight","_this$scale2","mapView","clientWidth","_this$scale3","mapElement","left","parseFloat","top","component"],"mappings":"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","file":"js/chunk-03911f96.f82d8732.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=style&index=0&id=6b817c29&prod&lang=less\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-maps\"},[_c('div',{ref:\"mapView\",staticClass:\"m-maps-pic\"},[(!_vm.mapId)?_c('div',{ref:\"mapWrap\",staticClass:\"m-map__wrap\",on:{\"mousedown\":_vm.handleMouseDown,\"mousemove\":_vm.handleMouseMove,\"mouseup\":_vm.handleMouseUp,\"wheel\":_vm.handleWheel}},[_c('div',{ref:\"map\",staticClass:\"m-map__world\",style:(`left:${(0 * _vm.scale.elWidth) / 100}px;top:${\n                    (25 * _vm.scale.elHeight) / 100\n                }px;transform-origin: ${_vm.scale.zoomOriginX}px ${_vm.scale.zoomOriginY}px; transform: scale(${\n                    _vm.scale.meter_zoom\n                });cursor: ${_vm.scale.isDragging ? 'grabbing' : 'grab'}`)},[_vm._l((_vm.mapData),function(item,id){return _c('span',{key:id,staticClass:\"u-map\",style:(`left:${item.x || 0}px;top:${item.y || 0}px`),on:{\"click\":function($event){return _vm.changeMap(item.mapid)}}},[_vm._v(\" \"+_vm._s(item.comment)+\" \")])}),_c('img',{staticClass:\"u-img\",attrs:{\"src\":_vm.map,\"alt\":\"世界地图\"}}),_c('img',{staticClass:\"u-traffic\",attrs:{\"src\":_vm.traffic,\"alt\":\"交通路线\"}})],2)]):_c('img',{attrs:{\"src\":_vm.currentMap}})]),_c('div',{staticClass:\"m-toolbar\"},[_c('h1',{staticClass:\"m-maps__title\"},[_vm._v(_vm._s(_vm.title))]),_c('el-input',{attrs:{\"size\":\"small\",\"clearable\":\"\"},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}},[_c('template',{slot:\"prepend\"},[_vm._v(\"地图\")])],2),_c('el-button-group',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"icon\":\"el-icon-arrow-left\"},on:{\"click\":function($event){return _vm.changePage('prev')}}},[_vm._v(\"上一页\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.changePage('next')}}},[_vm._v(\" 下一页 \"),_c('i',{staticClass:\"el-icon-arrow-right el-icon--right\"})])],1),_c('div',{staticClass:\"u-world-map\",on:{\"click\":function($event){return _vm.changeMap(0)}}},[_vm._v(\"世界地图\")]),_c('div',{class:[{ mapId: _vm.mapId }, 'm-mapList']},_vm._l((_vm.maps),function(item){return _c('div',{key:item.ID,class:['u-item', { active: item.ID == _vm.mapId }],attrs:{\"label\":item.MapName,\"value\":item.ID},on:{\"click\":function($event){return _vm.changeMap(item.ID)}}},[_vm._v(\" \"+_vm._s(item.MapName || item.Name)+\" \")])}),0)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $node, axios } from \"@jx3box/jx3box-common/js/https\";\r\n\r\nconst $ = $node();\r\n\r\nexport const getMaps = async (params) => $.get(`/map`, { params });\r\nexport const getMapsPoint = async (params) => $.get(`/map/map-point`, { params });\r\nexport const getMapsIdPoint = async (params) => $.get(`/map/id-to-point`, { params });\r\nexport const getMapsTraffic = async (params) => $.get(`/map/traffic-line`, { params });","<template>\n    <div class=\"m-maps\">\n        <div class=\"m-maps-pic\" ref=\"mapView\">\n            <div\n                class=\"m-map__wrap\"\n                ref=\"mapWrap\"\n                @mousedown=\"handleMouseDown\"\n                @mousemove=\"handleMouseMove\"\n                @mouseup=\"handleMouseUp\"\n                @wheel=\"handleWheel\"\n                v-if=\"!mapId\"\n            >\n                <div\n                    class=\"m-map__world\"\n                    ref=\"map\"\n                    :style=\"`left:${(0 * scale.elWidth) / 100}px;top:${\n                        (25 * scale.elHeight) / 100\n                    }px;transform-origin: ${scale.zoomOriginX}px ${scale.zoomOriginY}px; transform: scale(${\n                        scale.meter_zoom\n                    });cursor: ${scale.isDragging ? 'grabbing' : 'grab'}`\"\n                >\n                    <span\n                        class=\"u-map\"\n                        @click=\"changeMap(item.mapid)\"\n                        v-for=\"(item, id) in mapData\"\n                        :key=\"id\"\n                        :style=\"`left:${item.x || 0}px;top:${item.y || 0}px`\"\n                    >\n                        {{ item.comment }}\n                    </span>\n                    <img class=\"u-img\" :src=\"map\" alt=\"世界地图\" />\n                    <img class=\"u-traffic\" :src=\"traffic\" alt=\"交通路线\" />\n                </div>\n            </div>\n            <img :src=\"currentMap\" v-else />\n        </div>\n        <div class=\"m-toolbar\">\n            <h1 class=\"m-maps__title\">{{ title }}</h1>\n            <el-input size=\"small\" v-model=\"search\" clearable>\n                <template slot=\"prepend\">地图</template>\n            </el-input>\n            <el-button-group>\n                <el-button type=\"primary\" size=\"small\" icon=\"el-icon-arrow-left\" @click=\"changePage('prev')\"\n                    >上一页</el-button\n                >\n                <el-button type=\"primary\" size=\"small\" @click=\"changePage('next')\">\n                    下一页\n                    <i class=\"el-icon-arrow-right el-icon--right\"></i>\n                </el-button>\n            </el-button-group>\n            <div class=\"u-world-map\" @click=\"changeMap(0)\">世界地图</div>\n            <div :class=\"[{ mapId }, 'm-mapList']\">\n                <div\n                    v-for=\"item in maps\"\n                    :key=\"item.ID\"\n                    :label=\"item.MapName\"\n                    :value=\"item.ID\"\n                    @click=\"changeMap(item.ID)\"\n                    :class=\"['u-item', { active: item.ID == mapId }]\"\n                >\n                    {{ item.MapName || item.Name }}\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { getMaps, getMapsPoint } from \"@/service/maps.js\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nexport default {\n    name: \"Map\",\n    data() {\n        return {\n            loading: false,\n            mapId: 0,\n            maps: [],\n            mapData: [],\n\n            search: \"\",\n            page: 1,\n            per: 17,\n            count: 0,\n            title: \"\",\n\n            scale: {\n                initWidth: 0, // 父元素的宽-自适应值\n                initHeight: 0, // 父元素的高-自适应值\n                elWidth: 0, // 元素宽\n                elHeight: 0, // 元素高\n                meter_zoom: 0.28, // 子元素缩放比例\n                isDragging: false,\n                dragStartX: 0,\n                dragStartY: 0,\n                zoomOriginX: 0,\n                zoomOriginY: 0,\n                click: false,\n            },\n        };\n    },\n    computed: {\n        currentMap() {\n            return `${__imgPath}map/maps/map_${this.mapId}_0.png`;\n        },\n        map() {\n            return `${__imgPath}topic/pic/map.jpg?123`;\n        },\n        traffic() {\n            return `${__imgPath}topic/pic/traffic.png?123`;\n        },\n        client() {\n            return this.$store.state.client;\n        },\n        params() {\n            const _params = {\n                per: this.per,\n                page: this.page,\n                client: this.client,\n            };\n            if (this.search) _params.search = this.search;\n            return _params;\n        },\n    },\n    watch: {\n        params: {\n            deep: true,\n            handler: function () {\n                this.load();\n            },\n        },\n        mapId(val) {\n            if (val === null || val === \"\" || val === undefined) this.mapId = 0;\n            const map_1 = this.maps.filter((item) => item.ID == val)[0];\n            const map_2 = this.mapData.filter((item) => item.mapid == val)[0];\n            this.title = map_1?.MapName || map_2?.comment || \"世界地图\";\n        },\n    },\n    mounted() {\n        this.load();\n        this.loadOther();\n        this.initBodySize();\n    },\n    methods: {\n        changeMap(mapId) {\n            this.mapId = mapId || 0;\n            this.scale = this.$options.data().scale;\n        },\n        changePage(key) {\n            let page = this.page;\n            if (key === \"prev\") {\n                page--;\n            } else if (page < this.count / this.per) {\n                page++;\n            }\n            this.page = page < 0 ? 0 : page;\n        },\n        load() {\n            this.loading = true;\n            getMaps(this.params)\n                .then((res) => {\n                    const list = res.data.data.list || [];\n                    this.count = res.data.data.count;\n                    this.maps = list.map((item) => {\n                        if (!item.ID) item.MapName = \"世界地图\";\n                        return item;\n                    });\n                })\n                .finally(() => {\n                    this.loading = true;\n                });\n        },\n        loadOther() {\n            getMapsPoint({ client: this.client }).then((res) => {\n                const data = res.data.data.city || [];\n                this.mapData = data.filter((obj) => obj.comment && !obj.comment?.includes(\"测试\"));\n            });\n        },\n        handleWheel(event) {\n            let { meter_zoom, click, isDragging } = this.scale;\n            if (isDragging) return;\n            const delta = event.deltaY || event.deltaX;\n            let scaleNum = 0.05;\n            if (delta < 0) {\n                meter_zoom += scaleNum;\n                if (meter_zoom > 1.8) meter_zoom = 1.8;\n            } else {\n                meter_zoom -= scaleNum;\n                if (meter_zoom < 0.28) meter_zoom = 0.28;\n            }\n\n            // 获取鼠标点击位置相对于地图容器的坐标\n            const boundingRect = this.$refs.map.getBoundingClientRect();\n\n            const mouseX = click ? Math.floor(event.clientX - boundingRect.right * meter_zoom) : 0;\n            const mouseY = click ? Math.floor(event.clientY - boundingRect.bottom * meter_zoom) : 0;\n\n            // 更新缩放比例\n            this.$refs.map.style.transformOrigin = `${mouseX}px ${mouseY}px`;\n            this.$refs.map.style.transform = `scale(${meter_zoom})`;\n\n            this.scale.zoomOriginX = mouseX;\n            this.scale.zoomOriginY = mouseY;\n            this.scale.meter_zoom = meter_zoom;\n            event.preventDefault();\n        },\n        initBodySize() {\n            const imageWidth = 4920;\n            const imageHeight = 3456;\n\n            let { initWidth, initHeight, elWidth } = this.scale;\n            initWidth = this.$refs.mapView.clientWidth;\n            initHeight = initWidth * (imageHeight / imageWidth);\n            elWidth = initWidth * (100 / (imageWidth / 2));\n\n            this.scale.initHeight = initHeight;\n            this.scale.elWidth = elWidth;\n            this.scale.elHeight = initHeight * (100 / (imageHeight / 2));\n        },\n        handleMouseDown(event) {\n            this.scale.isDragging = true;\n            this.scale.click = true;\n            this.scale.dragStartX = event.clientX;\n            this.scale.dragStartY = event.clientY;\n        },\n        handleMouseMove(event) {\n            const { isDragging, dragStartX, dragStartY } = this.scale;\n            if (isDragging) {\n                const deltaX = event.clientX - dragStartX;\n                const deltaY = event.clientY - dragStartY;\n\n                // 更新地图的 left 和 top 属性\n                const mapElement = this.$refs.map;\n                mapElement.style.left = `${parseFloat(mapElement.style.left) + deltaX}px`;\n                mapElement.style.top = `${parseFloat(mapElement.style.top) + deltaY}px`;\n\n                this.scale.dragStartX = event.clientX;\n                this.scale.dragStartY = event.clientY;\n            }\n        },\n        handleMouseUp() {\n            this.scale.isDragging = false;\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/design/map.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./map.vue?vue&type=template&id=6b817c29\"\nimport script from \"./map.vue?vue&type=script&lang=js\"\nexport * from \"./map.vue?vue&type=script&lang=js\"\nimport style0 from \"./map.vue?vue&type=style&index=0&id=6b817c29&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}