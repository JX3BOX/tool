{"version":3,"sources":["webpack:///./src/components/design/map.vue?1676","webpack:///./src/components/design/map.vue","webpack:///./src/service/maps.js","webpack:///./src/components/design/dragWrap.vue","webpack:///src/components/design/dragWrap.vue","webpack:///./src/components/design/dragWrap.vue?f0ae","webpack:///./src/components/design/dragWrap.vue?b955","webpack:///src/components/design/map.vue","webpack:///./src/components/design/map.vue?78e7","webpack:///./src/components/design/map.vue?f85f"],"names":["render","_vm","this","_c","_self","staticClass","mapId","attrs","currentMap","_l","maps","item","id","key","style","concat","Left","Top","_v","_s","szDisplayName","map","traffic","title","model","value","search","callback","$$v","expression","slot","on","$event","changePage","changeMap","class","mapsList","ID","active","MapName","DisplayName","staticRenderFns","$","$node","getWorldMap","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","wrap","_context","prev","next","abrupt","get","stop","_x","apply","arguments","getMaps","_ref2","_callee2","_context2","_x2","ref","startDrag","drag","stopDrag","transform","position","x","y","scale","preventClick","_t","name","data","isDragging","startPosition","offset","velocity","lastPosition","lastTime","dampingFactor","momentumMultiplier","containerBounds","computed","mounted","_this","$nextTick","$refs","addEventListener","handleScroll","container","getBoundingClientRect","window","updateContainerBounds","imgs","document","getElementsByTagName","_toConsumableArray","forEach","img","event","preventDefault","methods","clientX","clientY","Date","now","currentTime","deltaTime","updateMomentumMultiplier","applyMomentum","currentX","currentY","distance","Math","sqrt","pow","_this2","momentumAnimation","abs","requestAnimationFrame","stopPropagation","delta","deltaY","detail","wheelDelta","scaleNum","beforeDestroy","removeEventListener","component","components","dragWrap","loading","page","per","count","initWidth","initHeight","elWidth","elHeight","meter_zoom","dragStartX","dragStartY","zoomOriginX","zoomOriginY","click","__imgPath","client","$store","state","_params","watch","deep","handler","load","val","undefined","map_1","filter","map_2","$options","then","res","list","zoning","finally"],"mappings":"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","file":"js/chunk-2c7cd49c.e31c42fa.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--11-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=style&index=0&id=31063e20&prod&lang=less\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"m-maps\"},[_c('div',{staticClass:\"m-maps-pic\"},[(!_vm.mapId)?[_c('dragWrap',[_c('div',{staticClass:\"m-map__world\"},[_vm._l((_vm.maps),function(item,id){return _c('span',{key:id,staticClass:\"u-map\",style:(`left:${item.Left || 0}px;top:${item.Top || 0}px`)},[_vm._v(\" \"+_vm._s(item.szDisplayName)+\" \")])}),_c('img',{staticClass:\"u-img\",attrs:{\"src\":_vm.map,\"alt\":\"世界地图\"}}),_c('img',{staticClass:\"u-traffic\",attrs:{\"src\":_vm.traffic,\"alt\":\"交通路线\"}})],2)])]:_c('img',{attrs:{\"src\":_vm.currentMap}})],2),_c('div',{staticClass:\"m-toolbar\"},[_c('h1',{staticClass:\"m-maps__title\"},[_vm._v(_vm._s(_vm.title))]),_c('el-input',{attrs:{\"size\":\"small\",\"clearable\":\"\"},model:{value:(_vm.search),callback:function ($$v) {_vm.search=$$v},expression:\"search\"}},[_c('template',{slot:\"prepend\"},[_vm._v(\"地图\")])],2),_c('el-button-group',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"icon\":\"el-icon-arrow-left\"},on:{\"click\":function($event){return _vm.changePage('prev')}}},[_vm._v(\"上一页\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":function($event){return _vm.changePage('next')}}},[_vm._v(\" 下一页 \"),_c('i',{staticClass:\"el-icon-arrow-right el-icon--right\"})])],1),_c('div',{staticClass:\"u-world-map\",on:{\"click\":function($event){return _vm.changeMap(0)}}},[_vm._v(\"世界地图\")]),_c('div',{class:[{ mapId: _vm.mapId }, 'm-mapList']},_vm._l((_vm.mapsList),function(item){return _c('div',{key:item.ID,class:['u-item', { active: item.ID == _vm.mapId }],attrs:{\"label\":item.MapName,\"value\":item.ID},on:{\"click\":function($event){return _vm.changeMap(item.ID)}}},[_vm._v(\" \"+_vm._s(item.DisplayName)+\" \")])}),0)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { $node, axios } from \"@jx3box/jx3box-common/js/https\";\r\n\r\nconst $ = $node();\r\n\r\nexport const getWorldMap = async (params) => $.get(`/map/worldmap`, { params });\r\nexport const getMaps = async (params) => $.get(`/map`, { params });\r\nexport const getMapsPoint = async (params) => $.get(`/map/map-point`, { params });\r\nexport const getMapsIdPoint = async (params) => $.get(`/map/id-to-point`, { params });\r\nexport const getMapsTraffic = async (params) => $.get(`/map/traffic-line`, { params });","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"container\",staticClass:\"p-map\",on:{\"mousedown\":_vm.startDrag,\"mousemove\":_vm.drag,\"mouseup\":_vm.stopDrag,\"mouseleave\":_vm.stopDrag}},[_c('div',{ref:\"map\",staticClass:\"m-list\",style:({ transform: `translate(${_vm.position.x}px, ${_vm.position.y}px) scale(${_vm.scale})` }),on:{\"click\":_vm.preventClick}},[_vm._t(\"default\")],2)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div\n        class=\"p-map\"\n        ref=\"container\"\n        @mousedown=\"startDrag\"\n        @mousemove=\"drag\"\n        @mouseup=\"stopDrag\"\n        @mouseleave=\"stopDrag\"\n    >\n        <div\n            class=\"m-list\"\n            ref=\"map\"\n            :style=\"{ transform: `translate(${position.x}px, ${position.y}px) scale(${scale})` }\"\n            @click=\"preventClick\"\n        >\n            <slot></slot>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"dragWrap\",\n    data() {\n        return {\n            scale: 0.2,\n\n            isDragging: false,\n            startPosition: { x: 0, y: 0 },\n            offset: { x: 0, y: 0 },\n            position: { x: 0, y: -1400 },\n            velocity: { x: 0, y: 0 },\n            lastPosition: { x: 0, y: 0 },\n            lastTime: 0,\n            dampingFactor: 0.9, // 越小速度衰减的越快\n            momentumMultiplier: 0, // 根据鼠标移动的距离动态计算惯性效果的远近\n            containerBounds: null,\n        };\n    },\n    computed: {},\n    mounted() {\n        this.$nextTick(() => {\n            const map = this.$refs.map;\n            map.addEventListener(\"wheel\", this.handleScroll);\n\n            this.containerBounds = this.$refs.container.getBoundingClientRect();\n            window.addEventListener(\"resize\", this.updateContainerBounds);\n\n            const imgs = document.getElementsByTagName(\"img\");\n            [...imgs].forEach((img) => {\n                img.addEventListener(\"dragstart\", (event) => {\n                    event.preventDefault();\n                });\n            });\n        });\n    },\n    methods: {\n        startDrag(event) {\n            this.isDragging = true;\n            this.startPosition.x = event.clientX;\n            this.startPosition.y = event.clientY;\n            this.offset.x = event.clientX - this.position.x;\n            this.offset.y = event.clientY - this.position.y;\n            this.velocity.x = 0;\n            this.velocity.y = 0;\n            this.lastTime = Date.now();\n            this.lastPosition.x = event.clientX;\n            this.lastPosition.y = event.clientY;\n        },\n        drag(event) {\n            if (this.isDragging) {\n                const currentTime = Date.now();\n                const deltaTime = currentTime - this.lastTime;\n\n                this.velocity.x = (event.clientX - this.lastPosition.x) / deltaTime;\n                this.velocity.y = (event.clientY - this.lastPosition.y) / deltaTime;\n\n                this.position.x = event.clientX - this.offset.x;\n                this.position.y = event.clientY - this.offset.y;\n                this.lastTime = currentTime;\n                this.lastPosition.x = event.clientX;\n                this.lastPosition.y = event.clientY;\n\n                this.updateMomentumMultiplier(event.clientX, event.clientY);\n            }\n        },\n        stopDrag() {\n            this.isDragging = false;\n            this.applyMomentum();\n        },\n        updateMomentumMultiplier(currentX, currentY) {\n            const distance = Math.sqrt(\n                Math.pow(currentX - this.startPosition.x, 2) + Math.pow(currentY - this.startPosition.y, 2)\n            );\n            this.momentumMultiplier = distance * 0.01;\n        },\n        applyMomentum() {\n            const momentumAnimation = () => {\n                this.position.x += this.velocity.x * this.momentumMultiplier;\n                this.position.y += this.velocity.y * this.momentumMultiplier;\n\n                if (Math.abs(this.velocity.x) > 0.1 || Math.abs(this.velocity.y) > 0.1) {\n                    this.velocity.x *= this.dampingFactor;\n                    this.velocity.y *= this.dampingFactor;\n                    requestAnimationFrame(momentumAnimation);\n                }\n            };\n\n            requestAnimationFrame(momentumAnimation);\n        },\n        updateContainerBounds() {\n            this.containerBounds = this.$refs.container.getBoundingClientRect();\n        },\n        preventClick(event) {\n            if (this.isDragging) {\n                event.stopPropagation();\n            }\n        },\n\n        handleScroll(event) {\n            const delta = event.deltaY || event.detail || event.wheelDelta;\n\n            let scaleNum = 0.05;\n            if (delta < 0) {\n                // 向上滚动，放大元素\n                this.scale += scaleNum;\n                if (this.scale > 1.8) {\n                    this.scale = 1.8;\n                }\n            } else {\n                // 向下滚动，缩小元素\n                this.scale -= scaleNum;\n                if (this.scale < 0.2) {\n                    this.scale = 0.2;\n                }\n            }\n\n            event.preventDefault();\n        },\n    },\n\n    beforeDestroy() {\n        window.removeEventListener(\"wheel\", this.handleScroll);\n        window.removeEventListener(\"resize\", this.updateContainerBounds);\n    },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./dragWrap.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./dragWrap.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./dragWrap.vue?vue&type=template&id=3b39bd6c\"\nimport script from \"./dragWrap.vue?vue&type=script&lang=js\"\nexport * from \"./dragWrap.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <div class=\"m-maps\">\n        <div class=\"m-maps-pic\">\n            <template v-if=\"!mapId\">\n                <dragWrap>\n                    <div class=\"m-map__world\">\n                        <span\n                            class=\"u-map\"\n                            v-for=\"(item, id) in maps\"\n                            :key=\"id\"\n                            :style=\"`left:${item.Left || 0}px;top:${item.Top || 0}px`\"\n                        >\n                            {{ item.szDisplayName }}\n                        </span>\n                        <img class=\"u-img\" :src=\"map\" alt=\"世界地图\" />\n                        <img class=\"u-traffic\" :src=\"traffic\" alt=\"交通路线\" />\n                    </div>\n                </dragWrap>\n            </template>\n\n            <img :src=\"currentMap\" v-else />\n        </div>\n\n        <div class=\"m-toolbar\">\n            <h1 class=\"m-maps__title\">{{ title }}</h1>\n            <el-input size=\"small\" v-model=\"search\" clearable>\n                <template slot=\"prepend\">地图</template>\n            </el-input>\n            <el-button-group>\n                <el-button type=\"primary\" size=\"small\" icon=\"el-icon-arrow-left\" @click=\"changePage('prev')\"\n                    >上一页</el-button\n                >\n                <el-button type=\"primary\" size=\"small\" @click=\"changePage('next')\">\n                    下一页\n                    <i class=\"el-icon-arrow-right el-icon--right\"></i>\n                </el-button>\n            </el-button-group>\n            <div class=\"u-world-map\" @click=\"changeMap(0)\">世界地图</div>\n            <div :class=\"[{ mapId }, 'm-mapList']\">\n                <div\n                    v-for=\"item in mapsList\"\n                    :key=\"item.ID\"\n                    :label=\"item.MapName\"\n                    :value=\"item.ID\"\n                    @click=\"changeMap(item.ID)\"\n                    :class=\"['u-item', { active: item.ID == mapId }]\"\n                >\n                    {{ item.DisplayName }}\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { getWorldMap, getMaps } from \"@/service/maps.js\";\nimport { __imgPath } from \"@jx3box/jx3box-common/data/jx3box.json\";\nimport dragWrap from \"./dragWrap.vue\";\nexport default {\n    name: \"Map\",\n    components: { dragWrap },\n    data() {\n        return {\n            loading: false,\n            mapId: 0,\n            maps: [],\n            mapsList: [],\n            search: \"\",\n            page: 1,\n            per: 17,\n            count: 0,\n            title: \"世界地图\",\n\n            scale: {\n                initWidth: 0, // 父元素的宽-自适应值\n                initHeight: 0, // 父元素的高-自适应值\n                elWidth: 0, // 元素宽\n                elHeight: 0, // 元素高\n                meter_zoom: 0.28, // 子元素缩放比例\n                isDragging: false,\n                dragStartX: 0,\n                dragStartY: 0,\n                zoomOriginX: 0,\n                zoomOriginY: 0,\n                click: false,\n            },\n        };\n    },\n    computed: {\n        currentMap() {\n            return `${__imgPath}map/maps/map_${this.mapId}_0.png`;\n        },\n        map() {\n            return `${__imgPath}topic/pic/map.jpg?123`;\n        },\n        traffic() {\n            return `${__imgPath}topic/pic/traffic.png?123`;\n        },\n        client() {\n            return this.$store.state.client;\n        },\n        params() {\n            const _params = {\n                per: this.per,\n                page: this.page,\n                client: this.client,\n            };\n            if (this.search) _params.search = this.search;\n            return _params;\n        },\n    },\n    watch: {\n        params: {\n            deep: true,\n            handler: function () {\n                this.load();\n            },\n        },\n        mapId(val) {\n            if (val === null || val === \"\" || val === undefined) this.mapId = 0;\n            const map_1 = this.maps.filter((item) => item.ID == val)[0];\n            const map_2 = this.mapsList.filter((item) => item.ID == val)[0];\n            this.title = map_1?.szDisplayName || map_2?.DisplayName || \"世界地图\";\n        },\n    },\n    mounted() {\n        this.load();\n    },\n    methods: {\n        changeMap(mapId) {\n            this.mapId = mapId || 0;\n            this.scale = this.$options.data().scale;\n        },\n        changePage(key) {\n            let page = this.page;\n            if (key === \"prev\") {\n                page--;\n            } else if (page < this.count / this.per) {\n                page++;\n            }\n            this.page = page < 0 ? 0 : page;\n        },\n        load() {\n            this.loading = true;\n            getWorldMap()\n                .then((res) => {\n                    const list = res.data.data.zoning || [];\n                    this.maps = list.filter((item) => item.szDisplayName);\n                })\n                .finally(() => {\n                    this.loading = true;\n                });\n            getMaps(this.params).then((res) => {\n                this.mapsList = res.data.data.list || [];\n                this.count = res.data.data.count;\n            });\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n@import \"~@/assets/css/design/map.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/vue-svg-inline-loader/dist/index.min.js!./map.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./map.vue?vue&type=template&id=31063e20\"\nimport script from \"./map.vue?vue&type=script&lang=js\"\nexport * from \"./map.vue?vue&type=script&lang=js\"\nimport style0 from \"./map.vue?vue&type=style&index=0&id=31063e20&prod&lang=less\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}