(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c7cd49c"],{"3b1c":function(t,i,a){"use strict";a("51a0")},"51a0":function(t,i,a){},"809b":function(t,i,a){"use strict";a.r(i);a("99af"),a("d81d"),a("ac1f"),a("841c");var n=function(){var t=this,i=t._self._c;return i("div",{staticClass:"m-maps"},[i("div",{staticClass:"m-maps-pic"},[t.mapId?i("img",{attrs:{src:t.currentMap}}):[i("dragWrap",[i("div",{staticClass:"m-map__world"},[t._l(t.maps,(function(a,n){return i("span",{key:n,staticClass:"u-map",style:"left:".concat(a.Left||0,"px;top:").concat(a.Top||0,"px")},[t._v(" "+t._s(a.szDisplayName)+" ")])})),i("img",{staticClass:"u-img",attrs:{src:t.map,alt:"世界地图"}}),i("img",{staticClass:"u-traffic",attrs:{src:t.traffic,alt:"交通路线"}})],2)])]],2),i("div",{staticClass:"m-toolbar"},[i("h1",{staticClass:"m-maps__title"},[t._v(t._s(t.title))]),i("el-input",{attrs:{size:"small",clearable:""},model:{value:t.search,callback:function(i){t.search=i},expression:"search"}},[i("template",{slot:"prepend"},[t._v("地图")])],2),i("el-button-group",[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-arrow-left"},on:{click:function(i){return t.changePage("prev")}}},[t._v("上一页")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(i){return t.changePage("next")}}},[t._v(" 下一页 "),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1),i("div",{staticClass:"u-world-map",on:{click:function(i){return t.changeMap(0)}}},[t._v("世界地图")]),i("div",{class:[{mapId:t.mapId},"m-mapList"]},t._l(t.mapsList,(function(a){return i("div",{key:a.ID,class:["u-item",{active:a.ID==t.mapId}],attrs:{label:a.MapName,value:a.ID},on:{click:function(i){return t.changeMap(a.ID)}}},[t._v(" "+t._s(a.DisplayName)+" ")])})),0)],1)])},e=[],s=(a("4de4"),a("d3b7"),a("c7eb")),o=a("1da1"),c=a("41cb"),r=Object(c["c"])(),l=function(){var t=Object(o["a"])(Object(s["a"])().mark((function t(i){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",r.get("/map/worldmap",{params:i}));case 1:case"end":return t.stop()}}),t)})));return function(i){return t.apply(this,arguments)}}(),u=function(){var t=Object(o["a"])(Object(s["a"])().mark((function t(i){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",r.get("/map",{params:i}));case 1:case"end":return t.stop()}}),t)})));return function(i){return t.apply(this,arguments)}}(),p=a("65c2"),m=function(){var t=this,i=t._self._c;return i("div",{ref:"container",staticClass:"p-map",on:{mousedown:t.startDrag,mousemove:t.drag,mouseup:t.stopDrag,mouseleave:t.stopDrag}},[i("div",{ref:"map",staticClass:"m-list",style:{transform:"translate(".concat(t.position.x,"px, ").concat(t.position.y,"px) scale(").concat(t.scale,")")},on:{click:t.preventClick}},[t._t("default")],2)])},h=[],d=a("2909"),f=(a("159b"),{name:"dragWrap",data:function(){return{scale:.2,isDragging:!1,startPosition:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:-1400},velocity:{x:0,y:0},lastPosition:{x:0,y:0},lastTime:0,dampingFactor:.9,momentumMultiplier:0,containerBounds:null}},computed:{},mounted:function(){var t=this;this.$nextTick((function(){var i=t.$refs.map;i.addEventListener("wheel",t.handleScroll),t.containerBounds=t.$refs.container.getBoundingClientRect(),window.addEventListener("resize",t.updateContainerBounds);var a=document.getElementsByTagName("img");Object(d["a"])(a).forEach((function(t){t.addEventListener("dragstart",(function(t){t.preventDefault()}))}))}))},methods:{startDrag:function(t){this.isDragging=!0,this.startPosition.x=t.clientX,this.startPosition.y=t.clientY,this.offset.x=t.clientX-this.position.x,this.offset.y=t.clientY-this.position.y,this.velocity.x=0,this.velocity.y=0,this.lastTime=Date.now(),this.lastPosition.x=t.clientX,this.lastPosition.y=t.clientY},drag:function(t){if(this.isDragging){var i=Date.now(),a=i-this.lastTime;this.velocity.x=(t.clientX-this.lastPosition.x)/a,this.velocity.y=(t.clientY-this.lastPosition.y)/a,this.position.x=t.clientX-this.offset.x,this.position.y=t.clientY-this.offset.y,this.lastTime=i,this.lastPosition.x=t.clientX,this.lastPosition.y=t.clientY,this.updateMomentumMultiplier(t.clientX,t.clientY)}},stopDrag:function(){this.isDragging=!1,this.applyMomentum()},updateMomentumMultiplier:function(t,i){var a=Math.sqrt(Math.pow(t-this.startPosition.x,2)+Math.pow(i-this.startPosition.y,2));this.momentumMultiplier=.01*a},applyMomentum:function(){var t=this,i=function i(){t.position.x+=t.velocity.x*t.momentumMultiplier,t.position.y+=t.velocity.y*t.momentumMultiplier,(Math.abs(t.velocity.x)>.1||Math.abs(t.velocity.y)>.1)&&(t.velocity.x*=t.dampingFactor,t.velocity.y*=t.dampingFactor,requestAnimationFrame(i))};requestAnimationFrame(i)},updateContainerBounds:function(){this.containerBounds=this.$refs.container.getBoundingClientRect()},preventClick:function(t){this.isDragging&&t.stopPropagation()},handleScroll:function(t){var i=t.deltaY||t.detail||t.wheelDelta,a=.05;i<0?(this.scale+=a,this.scale>1.8&&(this.scale=1.8)):(this.scale-=a,this.scale<.2&&(this.scale=.2)),t.preventDefault()}},beforeDestroy:function(){window.removeEventListener("wheel",this.handleScroll),window.removeEventListener("resize",this.updateContainerBounds)}}),g=f,v=a("2877"),y=Object(v["a"])(g,m,h,!1,null,null,null),w=y.exports,x={name:"Map",components:{dragWrap:w},data:function(){return{loading:!1,mapId:0,maps:[],mapsList:[],search:"",page:1,per:17,count:0,title:"世界地图",scale:{initWidth:0,initHeight:0,elWidth:0,elHeight:0,meter_zoom:.28,isDragging:!1,dragStartX:0,dragStartY:0,zoomOriginX:0,zoomOriginY:0,click:!1}}},computed:{currentMap:function(){return"".concat(p["__imgPath"],"map/maps/map_").concat(this.mapId,"_0.png")},map:function(){return"".concat(p["__imgPath"],"topic/pic/map.jpg?123")},traffic:function(){return"".concat(p["__imgPath"],"topic/pic/traffic.png?123")},client:function(){return this.$store.state.client},params:function(){var t={per:this.per,page:this.page,client:this.client};return this.search&&(t.search=this.search),t}},watch:{params:{deep:!0,handler:function(){this.load()}},mapId:function(t){null!==t&&""!==t&&void 0!==t||(this.mapId=0);var i=this.maps.filter((function(i){return i.ID==t}))[0],a=this.mapsList.filter((function(i){return i.ID==t}))[0];this.title=(null===i||void 0===i?void 0:i.szDisplayName)||(null===a||void 0===a?void 0:a.DisplayName)||"世界地图"}},mounted:function(){this.load()},methods:{changeMap:function(t){this.mapId=t||0,this.scale=this.$options.data().scale},changePage:function(t){var i=this.page;"prev"===t?i--:i<this.count/this.per&&i++,this.page=i<0?0:i},load:function(){var t=this;this.loading=!0,l().then((function(i){var a=i.data.data.zoning||[];t.maps=a.filter((function(t){return t.szDisplayName}))})).finally((function(){t.loading=!0})),u(this.params).then((function(i){t.mapsList=i.data.data.list||[],t.count=i.data.data.count}))}}},b=x,_=(a("3b1c"),Object(v["a"])(b,n,e,!1,null,null,null));i["default"]=_.exports}}]);
//# sourceMappingURL=chunk-2c7cd49c.e31c42fa.js.map